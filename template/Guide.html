<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>League of Stats - Guides</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='static/style/mainpage.css') }}" />
    <link rel="stylesheet" href="{{ url_for('static', filename='static/style/guide.css') }}" />
</head>

<body>
    <div class="main-container">
        <div class="sidebar">
            <div class="logo-area">LEAGUE OF STATS</div>

            <div class="sidebar-menu">
                <a href="{{ url_for('dashboard') }}">
                    <div class="icon-placeholder">
                        <img src="{{ url_for('static', filename='static/assets/icons/dashboard.png') }}" alt="Dashboard Icon" />
                    </div>
                    Dashboard
                </a>

                <a href="{{ url_for('share') }}">
                    <div class="icon-placeholder">
                        <img src="{{ url_for('static', filename='static/assets/icons/dashboard.png') }}" alt="Share Icon" />
                    </div>
                    Share
                </a>

                <a href="{{ url_for('friends') }}">
                    <div class="icon-placeholder">
                        <img src="{{ url_for('static', filename='static/assets/icons/dashboard.png') }}" alt="Friends Icon" />
                    </div>
                    Friends
                </a>

                <a href="{{ url_for('guide') }}" class="active">
                    <div class="icon-placeholder">
                        <img src="{{ url_for('static', filename='static/assets/icons/dashboard.png') }}" alt="Guides Icon" />
                    </div>
                    Guides
                </a>

                <a href="{{ url_for('characters') }}">
                    <div class="icon-placeholder">
                        <img src="{{ url_for('static', filename='static/assets/icons/characters.png') }}" alt="Characters Icon" />
                    </div>
                    Champions
                </a>

                <a href="{{ url_for('patchnotes') }}">
                    <div class="icon-placeholder">
                        <img src="{{ url_for('static', filename='static/assets/icons/patch.png') }}" alt="Patch Notes Icon" />
                    </div>
                    Patch Notes
                </a>
            </div>

            <a href="{{ url_for('profile') }}" class="profile-button">
                <div class="profile-icon">
                    <!-- User avatar placeholder -->
                </div>
                Profile
            </a>
        </div>

        <div class="content">
            <div class="Title">
                <h2>Guides</h2>
            </div>

            <div class="guides-content">
                <!-- Add guide content here -->
                <p>Welcome to the League of Stats Guides section! More content coming soon.</p>
            </div>

            <div class="guide-buttons">
                <a href="{{ url_for('create_guide') }}">
                    <button>Create a New Guide</button>
                </a>    
            
                <a href="{{ url_for('guide_inbox') }}">
                    <button>See New Guides</button>
                </a>    
            
                <a href="{{ url_for('user_guide') }}">
                    <button>See your guides</button>
                </a>  
            </div>

            <a href="{{ url_for('create_guide') }}">
                <button>Create a New Guide</button>
            </a>    

            <a href="{{ url_for('guide_inbox') }}">
                <button>See New Guides</button>
            </a>    

            <a href="{{ url_for('user_guide') }}">
                <button>See your guides</button>
            </a>  


        </div>
    </div>

    <div class="footer">
        League of Stats v1.0 â€¢ CITS3403 GROUP44 This website has no relation to RIOT GAMES
    </div>

    
<script>
document.addEventListener('DOMContentLoaded', () => {
  const friendModal = document.getElementById('friend-modal');
  const friendList = document.getElementById('friend-list');
  let currentGuideId = null;

  // Open friend modal on Send button click
  document.querySelectorAll('.send-btn').forEach(button => {
    button.addEventListener('click', () => {
      currentGuideId = button.dataset.guideId;
      friendList.innerHTML = 'Loading friends...';
      friendModal.style.display = 'block';

      // Fetch friends list from API
      fetch('/api/get_friends')
        .then(res => res.json())
        .then(data => {
          if (data.status === 'success') {
            friendList.innerHTML = '';
            data.data.forEach(friend => {
              const li = document.createElement('li');
              li.textContent = friend.username;
              li.style.cursor = 'pointer';
              li.style.padding = '5px';
              li.addEventListener('click', () => sendGuideToFriend(friend.id));
              friendList.appendChild(li);
            });
          } else {
            friendList.innerHTML = 'Failed to load friends.';
          }
        });
    });
  });

  // Close modal
  document.getElementById('close-friend-modal').addEventListener('click', () => {
    friendModal.style.display = 'none';
  });

  // Send guide to selected friend
  function sendGuideToFriend(friendId) {
    fetch('/api/send_guide', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ guide_id: currentGuideId, friend_id: friendId })
    })
    .then(res => res.json())
    .then(data => {
      alert(data.message);
      friendModal.style.display = 'none';
    })
    .catch(() => alert('Error sending guide'));
  }

  // Delete guide on Delete button click
  document.querySelectorAll('.delete-btn').forEach(button => {
    button.addEventListener('click', () => {
      const guideId = button.dataset.guideId;
      if (confirm('Are you sure you want to delete this guide?')) {
        fetch('/api/delete_guide', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ guide_id: guideId })
        })
        .then(res => res.json())
        .then(data => {
          alert(data.message);
          if (data.status === 'success') {
            // Remove guide from the list visually
            const guideElem = document.getElementById(`guide-${guideId}`);
            if (guideElem) guideElem.remove();
          }
        })
        .catch(() => alert('Error deleting guide'));
      }
    });
  });
});
</script>

</body>
</html>



